<head>
    <title>RSA</title>
    <link rel="stylesheet" href="https://use.typekit.net/yhe5mma.css">
    <link rel="stylesheet" type="text/css" id="stylesheet" href="../css/main.css">
    <link rel="stylesheet" type="text/css" href="../css/mediaquery.css">
    <meta charSet="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="../js/browsers.js"></script>
</head>

<div class="header">
    <div class="typewriter">
    <h1>RSA Algorithm</h1>
    </div>
</div>

<div class="logo">
    <a href="../index.html">
        <img src="../img/Final-Logo.png" height="100px">
    </a>
</div>

<ul class="navigation">
    <li><a href="../index.html" class="three-d">
            Home
            <span class="three"><span class="front">Home</span><span class="back">Home</span></span>
        </a></li>
    <li><a href="about.html" class="three-d">
            About
            <span class="three"><span class="front">About</span><span class="back">About</span></span>
        </a></li>
    <li><a href="#Resources" class="three-d">
            Resources
            <span class="three"><span class="front">Resources</span><span class="back">Resources</span></span>
        </a>
        <ul>
            <li><a href="history.html" class="three-d">
                    History
                    <span class="three"><span class="front">History</span><span class="back">History</span></span>
                </a>
                <ul class="side-dropdown">
                    <li><a href="enigma.html" class="three-d">
                            Enigma
                            <span class="three"><span class="front">Enigma</span><span class="back">Enigma</span></span>
                        </a></li>
                    <li><a href="ww2.html" class="three-d">
                            WWII
                            <span class="three"><span class="front">WWII</span><span class="back">WWII</span></span>
                        </a></li>
                </ul>
            </li>
            <li><a href="#" class="three-d">
                    CryptoWars
                    <span class="three"><span class="front">CryptoWars</span><span class="back">CryptoWars</span></span>
                </a>
                <ul class="side-dropdown1">
                    <li><a href="cryptowars1.html" class="three-d">
                            The Beginning
                            <span class="three"><span class="front">The Beginning</span><span class="back">The
                                    Beginning</span></span>
                        </a></li>
                    <li><a href="cryptowars2.html" class="three-d">
                            The Internet
                            <span class="three"><span class="front">The Internet</span><span class="back">The
                                    Internet</span></span>
                        </a></li>
                    <li><a href="cryptowars3.html" class="three-d">
                            U.S. Government
                            <span class="three"><span class="front">U.S. Government</span><span class="back">U.S.
                                    Government</span></span>
                        </a></li>
                    <li><a href="cryptowars4.html" class="three-d">
                            Cracking DES
                            <span class="three"><span class="front">Cracking DES</span><span class="back">Cracking
                                    DES</span></span>
                        </a></li>
                    <li><a href="cryptowars5.html" class="three-d">
                            Ongoing War
                            <span class="three"><span class="front">Ongoing War</span><span class="back">Ongoing
                                    War</span></span>
                        </a></li>
                </ul>
            </li>
            <li><a href="cryptosystem.html" class="three-d">
                Cryptosystems
                <span class="three"><span class="front">Cryptosystems</span><span class="back">Cryptosystems</span></span>
            </a>
            <ul class="side-dropdown2">
                <li><a href="symmetricKey.html" class="three-d">
                        Symmetric Key
                        <span class="three"><span class="front">Symmetric Key</span><span class="back">Symmetric Key</span></span>
                    </a></li>
                    <li><a href="asymmetricKey.html" class="three-d">
                        Asymmetric Key
                        <span class="three"><span class="front">Asymmetric Key</span><span class="back">Asymmetric Key</span></span>
                    </a></li>
                <li><a href="principles.html" class="three-d">
                        Kerckhoff & Shannon
                        <span class="three"><span class="front">Kerckhoff & Shannon</span><span class="back">Kerckhoff & Shannon</span></span>
                    </a></li>
            </ul>
        </li>
            <li><a href="division.html" class="three-d">
                    Division
                    <span class="three"><span class="front">Division</span><span class="back">Division</span></span>
                </a>
                <ul class="side-dropdown3">
                    <li><a href="euclid.html" class="three-d">
                            Euclid's Algorithm
                            <span class="three"><span class="front">Euclid's Algorithm</span><span class="back">Euclid's
                                    Algorithm</span></span>
                        </a></li>
                    <li><a href="bezout.html" class="three-d">
                            Bezout's Identity
                            <span class="three"><span class="front">Bezout's Identity</span><span class="back">Bezout's
                                    Identity</span></span>
                        </a></li>
                </ul>
            </li>
            <li><a href="rsa.html" class="three-d">
                    RSA
                    <span class="three"><span class="front">RSA</span><span class="back">RSA</span></span>
                </a>
                <ul class="side-dropdown4">
                    <li><a href="primes.html" class="three-d">
                            Primes
                            <span class="three"><span class="front">Primes</span><span class="back">Primes</span></span>
                        </a></li>
                    <li><a href="modularArithmetic.html" class="three-d">
                            Modular Arithmetic
                            <span class="three"><span class="front">Modular Arithmetic</span><span class="back">Modular
                                    Arithmetic</span></span>
                        </a></li>
                    <li><a href="chineseRemainder.html" class="three-d">
                            Chinese Remainder Theorem
                            <span class="three"><span class="front">Chinese Remainder Theorem</span><span
                                    class="back">Chinese Remainder Theorem</span></span>
                        </a></li>
                        <li><a href="euler.html" class="three-d">
                            Euler's Theorem
                            <span class="three"><span class="front">Euler's Theorem</span><span
                                    class="back">Euler's Theorem</span></span>
                        </a></li>
                </ul>
            </li>
            <li><a href="ellipticCurve.html" class="three-d">
                Elliptic-Curve
                <span class="three"><span class="front">Elliptic-Curve</span><span class="back">Elliptic-Curve</span></span>
            </a>
            <ul class="side-dropdown5">
                
            </ul>
        </li>
            <li><a href="#" class="three-d">
                Algorithms
                <span class="three"><span class="front">Algorithms</span><span class="back">Algorithms</span></span>
            </a>
            <ul class="side-dropdown6">
                <li><a href="aes.html" class="three-d">
                    AES
                    <span class="three"><span class="front">AES</span><span class="back">AES</span></span>
                </a></li>
                <li><a href="diffieHellman.html" class="three-d">
                        Diffie Hellman
                        <span class="three"><span class="front">Diffie Hellman</span><span class="back">Diffie Hellman</span></span>
                    </a></li>
                <li><a href="shamir.html" class="three-d">
                        Shamir's Secret
                        <span class="three"><span class="front">Shamir's Secret</span><span class="back">Shamir's Secret</span></span>
                    </a></li>
                    <li><a href="shor.html" class="three-d">
                        Shor's Algorithm
                        <span class="three"><span class="front">Shor's Algorithm</span><span class="back">Shor's Algorithm</span></span>
                    </a></li>
            </ul>
            </li>
            <li><a href="#" class="three-d">
                Programming
                <span class="three"><span class="front">Programming</span><span class="back">Programming</span></span>
            </a>
            <ul class="side-dropdown7">
                <li><a href="branchlessProgramming.html" class="three-d">
                        Branchless Programming
                        <span class="three"><span class="front">Branchless Programming</span><span class="back">Branchless Programming</span></span>
                    </a></li>
                    <li><a href="programRsa.html" class="three-d">
                        RSA in Python
                        <span class="three"><span class="front">RSA in Python</span><span class="back">RSA in Python</span></span>
                    </a></li>
                    <li><a href="programAES.html" class="three-d">
                        AES in Python
                        <span class="three"><span class="front">AES in Python</span><span class="back">AES in Python</span></span>
                    </a></li>
                    <li><a href="programEnigma.html" class="three-d">
                        Enigma in Python
                        <span class="three"><span class="front">Enigma in Python</span><span class="back">Enigma in Python</span></span>
                    </a></li>
                    <li><a href="quantum.html" class="three-d">
                        Quantum
                        <span class="three"><span class="front">Quantum</span><span class="back">Quantum</span></span>
                    </a></li>
            </ul>
            </li>
        </ul>
    </li>
    <li><a href="#Quizzes" class="three-d">
            Quizzes
            <span class="three"><span class="front">Quizzes</span><span class="back">Quizzes</span></span>
        </a>
        <ul>
            <li><a href="historyQuiz.html" class="three-d">
                    History
                    <span class="three"><span class="front">History</span><span class="back">History</span></span>
                </a></li>
            <li><a href="cryptoWarsQuiz.html" class="three-d">
                    CryptoWars
                    <span class="three"><span class="front">CryptoWars</span><span class="back">CryptoWars</span></span>
            </a></li>
            <li><a href="cryptosystemsQuiz.html" class="three-d">
                Cryptosystems
                <span class="three"><span class="front">Cryptosystems</span><span class="back">Cryptosystems</span></span>
        </a></li>
            <li><a href="divisionQuiz.html" class="three-d">
                    Division
                    <span class="three"><span class="front">Division</span><span class="back">Division</span></span>
                </a></li>
            <li><a href="rsaQuiz.html" class="three-d">
                    RSA
                    <span class="three"><span class="front">RSA</span><span class="back">RSA</span></span>
            </a></li>
            <li><a href="ellipticCurveQuiz.html" class="three-d">
                Elliptic-Curve
                <span class="three"><span class="front">Elliptic-Curve</span><span class="back">Elliptic-Curve</span></span>
        </a></li>
            <li><a href="algorithmsQuiz.html" class="three-d">
                Other Algorithms
                <span class="three"><span class="front">Other Algorithms</span><span class="back">Other Algorithms</span></span>
        </a></li>
        <li><a href="quantumQuiz.html" class="three-d">
            Quantum Quiz
            <span class="three"><span class="front">Quantum Quiz</span><span class="back">Quantum Quiz</span></span>
    </a></li>
        </ul>
    </li>
    <li><a href="support.html" class="three-d">
            Support
            <span class="three"><span class="front">Support</span><span class="back">Support</span></span>
        </a></li>
    <li><a href="contact.html" class="three-d">
            Contact
            <span class="three"><span class="front">Contact</span><span class="back">Contact</span></span>
        </a></li>
</ul>

<div class="box">
    <body>
        <h2>RSA Algorithm</h2>
    
        <div class="text-box">
        <p>RSA (Rivest–Shamir–Adleman) was one of the first <a href="asymmetricKey.html">public key</a> cryptosystems and is widely used to securely send messages over the internet. The implementation of RSA makes heavy use of <a href="modularArithmetic.html">modular arithmetic</a>, <a href="euler.html">Euler's theorem, and Euler's totient function</a> that we have explained on the previous pages.
<img src="../img/rsa.png" class="imgRight" width="450">
The idea is that we choose n = pq, choose e with gcd(e, 𝜙(n)) = 1, and find d with ed &equiv; 1 (mod 𝜙(n)).
            
To encipher: P &rarr; E(P) &equiv; P<sup>e</sup> (mod n), where P denotes the plaintext and E denotes encrypt.
To decipher: Q &rarr; D(Q) &equiv; Q<sup>d</sup> (mod n), where Q denotes the ciphertext and D denotes decrypt.
            
To encode we need to know (n, e) and to decode, we need to know (n, d).
            
<b>Key Generation</b>
First, the receiver chooses two large primes p and q. The product n = pq forms half of the public key. We then use the totient function on n, denoted 𝜙(n),
            
<div class="calculation">𝜙(n) = 𝜙(pq) 
= 𝜙(p)𝜙(q) 
= (p - 1)(q - 1)
= pq - p - q + 1</div> 
If we know n and 𝜙(n), we can determine p and q. Rearranging the above equation, we get 
<div class="calculation">p + q = pq + 1 - 𝜙(n)</div>
            
This can be written in the form of a polynomial:
<div class="calculation">x&sup2; - (p + q)x + pq = (x - q)(x - p)</div>
            
<b>Example:</b>
Let n = 187 and 𝜙(n) = 160. Determine p and q. 
From the question we know, pq = 187 so p + q = 187 + 1 -160 = 28. Rewriting this as a polynomial,  
<div class="calculation">x&sup2; - 28x + 187 = 0</div>

Using the quadratic function, we obtain the roots; 
x = (28 &plusmn; &radic;28&sup2; - 4(1)(187)) / 2
  = (28 &plusmn; &radic;784; - 748) / 2
  = (28 &plusmn; &radic;36) / 2
  = (28 &plusmn; 6) / 2
  = 17, 11
So p = 11, q = 17.

<b>Finding the Decryption Key</b>
For the purpose of this example we’ve chosen very small primes but for encryption to be secure, remember you must choose large primes.

Let
<div class="calculation">p = 17 and q = 19</div>

And multiply to find n, the modulus
<div class="calculation">n = pq = 17 x 19 = 323
𝜙(323) = (17 - 1)(19 -1) = 16 x 18 = 288</div>
We then choose e, which must be between 1 and 𝜙(n), and coprime to 𝜙(n), i.e. gcd(e, 𝜙(n)) = 1. Let;
<div class="calculation">e = 61</div>

The decryption key, d, is such that
<div class="calculation">ed &equiv; 1 mod 𝜙(n)</div>
This can be calculated using the <a href="bezout.html">extended Euclidean algorithm</a>.

288 = (61 x 4) + 44
61 = (44 x 1) + 17
44 = (17 x 2) + 10
17 = 10 + 7 
10 = 7 + 3
7 = (3 x 2) + 1

1 = 7 - 2(3) 
  = 7 - 2(10 - 7)
  = 3(7) - 2(10)
  = 3(17 - 10) - 2(10)
  = 3(17) - 5(10)
  = 3(17) - 5[44 - 2(17)]
  = 13(17) - 5(44)
  = 13(61 - 44) - 5(44)
  = 13(61) - 18(44)
  = 13(61) - 18[288 - 4(61)]
  = 85(61) - 18(288)

When compared to the earlier formula de ≡ 1 mod 𝜙(n), you can see that the coefficient of e = 61 is 85, the decryption key.

Now we understand how to find the decryption key, let’s try to decrypt a secret message. We will assume that each letter of the alphabet has been given a number, i.e. A = 01, B = 02,..., Z = 26.

<b>Example:</b>
Your public key is (n,e) = (2173, 3) where n = 2173. You receive the message
1865 0183 1955 0308 0034 2130 0530
What does it say and what decryption exponent did you use?

(n, e) = (2173, 3) where n = 2173 = 41*53 (p*q)

P &rarr; E(P) &equiv; P<sup>e</sup> (mod n)
&equiv; P<sup>3</sup> (mod 2173)

To decode, we need (n, d) = (2173, d) where ed &equiv; 1 mod 𝜙(n), 3d &equiv; 1 (mod 𝜙(2173)).

𝜙(n) = (p - 1)(q - 1)
𝜙(2173) = (41 - 1)(53 - 1)
        = (40)(52)
        = 2080

3d &equiv; 1 (mod 2080)
3d &equiv; 1 + 2080k
1 = 3d - 2080k

gcd(2080, 3)
2080 = 3(693) + 1
1 = 2080 + (-693)3

Therefore, d = -693
= -693 + 2080 (to make d positive add the modulus to the negative number)
= 1387 

D(E(P)) = 1865<sup>1387</sup> 0183<sup>1387</sup> 1955<sup>1387</sup> 0308<sup>1387</sup> 0034<sup>1387</sup> 2130<sup>1387</sup> 0530<sup>1387</sup> (mod 2173)

P = 2015 1815 1420 1509 1903 1512 0424
  = T O  R O  N T  O I  S C   O L  D X
<u> = Toronto is cold</u> 


<b>Encryption</b>
The formula you need for encryption in RSA is
<div class="calculation">C = M<sup>e</sup> (mod n)</div>

Where C is the ciphertext, M is the plaintext message, e is a number coprime to  (which must be between one and 𝜙(n), non-inclusive) and n is the modulus.

If you are working out an RSA encryption by hand, you will find that you can’t calculate on your calculator x<sup>61</sup>, therefore, you have to expand your expression using several laws of indices. As 61 is a prime number, this cannot be simplified into factors. However,

<div class="calculation">𝑥<sup>61</sup> = 𝑥<sup>60</sup> * 𝑥</div>

𝑥<sup>60</sup> can be simplified by finding its factors. 60 = 10 x 6 = 5 x 2 x 6 = 5 x 3 x 2 x 2 using <a href="primes.html">prime factorisation</a>

<div class="calculation">𝑥<sup>60</sup> = {[(𝑥<sup>5</sup>)<sup>3</sup>]<sup>2</sup>}<sup>2</sup></div>

By inserting the expression for 𝑥<sup>60</sup> into the expression for 𝑥<sup>61</sup> you have the following:

<div class="calculation">𝑥<sup>61</sup> = {[(𝑥<sup>5</sup>)<sup>3</sup>]<sup>2</sup>}<sup>2</sup> * 𝑥</div>

NOTES
After each step you should be applying the modulus, as shown in the image below. 
𝑥<sup>mn</sup> = (𝑥<sup>m</sup>)<sup>n</sup>  [Solve 𝑥<sup>m</sup> first, then multiply the result by itself n times]
𝑥<sup>m+n</sup> = 𝑥<sup>m</sup>*𝑥<sup>n</sup> [Solve 𝑥<sup>m</sup> and 𝑥<sup>n</sup> individually and multiply the results together]
In the image below [(M<sup>5</sup>)<sup>4</sup>]<sup>3</sup> was possible to calculate and quicker than {[(M<sup>5</sup>)<sup>3</sup>]<sup>2</sup>}<sup>2</sup>

<img src="../img/RSA-ENC.PNG" class="imgCenter" width="900">
<b>Decryption</b>
The decryption formula is
<div class="calculation">M = C<sup>d</sup> (mod n)</div>

The decryption can be worked out using the same method as before, but using d, the decryption key and not e. d is the multiplicative inverse of e mod 𝜙(n).

Where d = 85, 85 = [(5 + 2) x 4 x 3] + 1, therefore
<div class="calculation">𝑥<sup>85</sup> = [(𝑥<sup>5</sup> * 𝑥<sup>2</sup>)<sup>4</sup>]<sup>3</sup> * 𝑥</div>
<img src="../img/RSA-DEC.PNG" class="imgCenter" width="900">
        </p>
<i>Written by <b>Chelsea and JaneW</b></i>
</p>
        </div>
    </body>
</div>

<footer>
    <div class="nextButton">
        <a href="euler.html" class="three-d">
          Euler's Theorem < <span class="three"><span class="front">
            Euler's Theorem < </span><span class="back">
                Euler's Theorem < </span>
                        </span>
        </a>
        <a href="rsaQuiz.html" class="three-d">
            > RSA Quiz
            <span class="three"><span class="front">> RSA Quiz</span><span class="back">> RSA Quiz</span></span>
        </a>
    </div>
</footer>